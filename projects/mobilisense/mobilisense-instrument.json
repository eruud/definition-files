{
  "definition_type":"instrument",
  "code":"ema_mobilisense_app",
  "name":"Mobilisense App",
  "description":"To be done",
  "version":1,
  "customizations":{
    "package":"com.pilrhealth.instruments.ema_ots",
    "classnamePrefix":"EmaOts",
    "apix":true,
    "controllers":{
      "configure":"EmaOtsConfig",
      "coordinate":"EmaOts"
    },
    "services":{
      "handleContent":"EmaOtsConfig"
    }
  },
  "settings": [
    {
      "type": "configuration_setting",
      "code": "ema_ots:ema_config",
      "name": "App Configuration",
      "description": "The configuration of the app content to be delivered to the participant."
    }
  ],
  "datasets":[
    {
      "name":"Inactivity Notifications",
      "code":"pilrhealth:activity_monitoring_app:inactivity_notifications",
      "schemas":[
        {
          "type":"concordia",
          "name":"Version 1",
          "schemaVersion":1,
          "specification":{
            "type":"object",
            "fields":[
              {
                "type":"string",
                "category":"date",
                "label":"Activity: Notification Delivery Date",
                "name":"notification_delivery_date",
                "optional":false
              },
              {
                "type":"boolean",
                "label":"Activity: Notification Cancelled No Response",
                "name":"notification_cancelled_no_response"
              },
              {
                "type":"number",
                "label":"Activity: Notification Question Response",
                "name":"notification_question_response",
                "optional":true
              },
              {
                "type":"number",
                "label":"Activity: Notification Snooze Time",
                "name":"notification_snooze_time",
                "optional":true
              },
              {
                "type":"string",
                "label":"Activity: Notification Message Delivered",
                "name":"notification_message_delivered",
                "optional":true
              }
            ]
          }
        }
      ]
    },
    {
      "name":"Survey Data",
      "code":"pilrhealth:mobile:survey_data",
      "schemas":[
        {
          "type":"concordia",
          "schemaVersion":1,
          "name":"1.0",
          "specification":{
            "type":"object",
            "fields":[
              {
                "name":"event_type",
                "type":"string",
                "label":"Event Type"
              },
              {
                "name":"survey_code",
                "type":"string",
                "label":"Survey Code",
                "optional":true
              },
              {
                "name":"self_report",
                "type":"boolean",
                "label":"Self Report",
                "doc":"Track if this submission was self reported",
                "optional":true
              },
              {
                "name":"session",
                "type":"string",
                "label":"Session"
              },
              {
                "name":"question_type",
                "type":"string",
                "label":"Question Type",
                "optional":true
              },
              {
                "name":"question_code",
                "type":"string",
                "label":"Question Code",
                "optional":true
              },
              {
                "name":"response",
                "type":"string",
                "label":"Response",
                "optional":true
              },
              {
                "name":"response_value",
                "type":"string",
                "label":"Response Value",
                "optional":true
              },
              {
                "name":"responses",
                "type":"array",
                "constType":{
                  "type":"string"
                },
                "label":"Responses",
                "optional":true
              },
              {
                "name":"response_values",
                "type":"array",
                "constType":{
                  "type":"string"
                },
                "label":"Response Values",
                "optional":true
              },
              {
                "label":"Additional Data",
                "optional":true,
                "type":"object",
                "name":"more_data",
                "fields":[
                  {
                    "name":"text",
                    "type":"string",
                    "label":"Text",
                    "optional":true
                  },
                  {
                    "name":"value",
                    "type":"string",
                    "label":"Value",
                    "optional":true
                  },
                  {
                    "name":"selected",
                    "type":"boolean",
                    "label":"Selected",
                    "optional":true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    {
      "name":"Compliance_Log",
      "code":"pilrhealth:mobile:comp_log",
      "schemas":[
        {
          "clazz":"com.pilrhealth.data.ConcordiaSchema",
          "name":"1.0",
          "schemaVersion":1,
          "specification":{
            "type":"object",
            "fields":[
              {
                "label":"Total Started Surveys",
                "name":"total_started",
                "type":"number"
              },
              {
                "label":"Total Submitted Surveys",
                "name":"total_submitted",
                "type":"number"
              },
              {
                "label":"Total Notifications",
                "name":"total_notifications",
                "type":"number"
              },
              {
                "label":"Percent Completed Surveys",
                "name":"percent_completed",
                "type":"number"
              },
              {
                "label":"Avg Time To Comp Surveys",
                "name":"time_taken",
                "type":"number"
              }
            ]
          }
        }
      ]
    },
    {
      "name":"Notification Log",
      "code":"pilrhealth:mobile:notification_log",
      "schemas":[
        {
          "clazz":"com.pilrhealth.data.ConcordiaSchema",
          "name":"1.0",
          "schemaVersion":1,
          "specification":{
            "type":"object",
            "fields":[
              {
                "name":"session",
                "type":"string",
                "label":"Session"
              },
              {
                "name":"notif_time",
                "type":"string",
                "category":"date",
                "label":"Notification Time"
              },
              {
                "name":"expir_time",
                "type":"string",
                "category":"date",
                "label":"Expiration Time"
              },
              {
                "name":"survey_code",
                "label":"Survey Code",
                "type":"string",
                "optional":true
              },
              {
                "name":"trigger_code",
                "label":"Trigger Code",
                "type":"string",
                "optional":true
              }
            ]
          }
        }
      ]
    },
    {
      "name":"Compliance Events",
      "code":"pilrhealth:mobile:comp_events",
      "schemas":[
        {
          "type":"concordia",
          "name":"1.0",
          "schemaVersion":2,
          "specification":{
            "type":"object",
            "fields":[
              {
                "name":"session",
                "label":"Session",
                "type":"string"
              },
              {
                "name":"notif_time",
                "label":"Notification Time",
                "category":"date",
                "type":"string",
                "optional":true
              },
              {
                "name":"expir_time",
                "label":"Expiration Time",
                "category":"date",
                "type":"string",
                "optional":true
              },
              {
                "name":"survey_code",
                "label":"Survey code",
                "type":"string"
              },
              {
                "name":"trigger_code",
                "label":"Trigger code",
                "type":"string"
              },
              {
                "name":"completed",
                "label":"Completed",
                "category":"date",
                "type":"string"
              },
              {
                "name":"type",
                "label":"Type",
                "type":"string"
              }
            ]
          }
        }
      ]
    },
    {
      "name":"App Log",
      "code":"pilrhealth:mobile:app_log",
      "schemas":[
        {
          "type":"concordia",
          "schemaVersion":1,
          "name":"1.0",
          "specification":{
            "type":"object",
            "fields":[
              {
                "name":"level",
                "optional":false,
                "doc":"One of: error, warning, debug, or info.",
                "label":"Log level",
                "type":"string"
              },
              {
                "name":"tag",
                "optional":true,
                "doc":"A searchable string for event analytics.",
                "label":"Tag",
                "type":"string"
              },
              {
                "name":"msg",
                "optional":false,
                "doc":"Human readable message.",
                "label":"Message",
                "type":"string"
              },
              {
                "label":"Additional Data",
                "optional":true,
                "type":"object",
                "name":"args",
                "fields":[

                ]
              }
            ]
          }
        }
      ]
    },
    {
      "name":"Moves Trip Data",
      "code":"pilrhealth:moves:trip_data",
      "schemas":[
        {
          "type":"concordia",
          "schemaVersion":1,
          "name":"1.0",
          "specification":{
            "type":"object",
            "fields":[
              {
                "name":"tripId",
                "label":"Trip Identifier",
                "type":"string"
              },
              {
                "name":"trips",
                "label":"Trips",
                "type":"array",
                "constType":{
                  "type":"object",
                  "fields":[
                    {
                      "category":"date",
                      "name":"start_time",
                      "label":"Trip Start Time",
                      "type":"string"
                    },
                    {
                      "category":"date",
                      "name":"end_time",
                      "label":"Trip End Time",
                      "type":"string"
                    },
                    {
                      "name":"type",
                      "label":"Trip Type",
                      "type":"string"
                    },
                    {
                      "name":"startLocation",
                      "label":"Trip Start Location",
                      "type":"string"
                    },
                    {
                      "name":"endLocation",
                      "label":"Trip End Location",
                      "type":"string"
                    }
                  ]
                }
              }
            ]
          }
        }
      ]
    },
    {
      "name":"Moves Storyline Data",
      "code":"pilrhealth:moves:storyline_data",
      "schemas":[
        {
          "type":"concordia",
          "schemaVersion":1,
          "name":"1.0",
          "specification":{
            "type":"object",
            "fields":[
              {
                "name":"storylineId",
                "label":"Storyline Identifier",
                "type":"string"
              },
              {
                "name":"storyline",
                "label":"Storyline",
                "type":"object",
                "fields":[
                  {
                    "category":"date",
                    "name":"date",
                    "label":"Date",
                    "type":"string"
                  },
                  {
                    "type":"array",
                    "name":"summary",
                    "label":"Summary",
                    "constType":{
                      "type":"object",
                      "fields":[
                        {
                          "name":"activity",
                          "label":"Activity",
                          "type":"string"
                        },
                        {
                          "name":"group",
                          "label":"Group",
                          "type":"string",
                          "optional":true
                        },
                        {
                          "name":"duration",
                          "label":"Duration",
                          "type":"number"
                        },
                        {
                          "name":"distance",
                          "label":"Distance",
                          "type":"number",
                          "optional":true
                        },
                        {
                          "name":"steps",
                          "label":"Steps",
                          "type":"number",
                          "optional":true
                        },
                        {
                          "name":"calories",
                          "label":"Calories",
                          "type":"number",
                          "optional":true
                        }
                      ]
                    }
                  },
                  {
                    "type":"array",
                    "name":"segments",
                    "label":"Segments",
                    "constType":{
                      "type":"object",
                      "fields":[
                        {
                          "name":"type",
                          "label":"Type",
                          "type":"string"
                        },
                        {
                          "category":"date",
                          "name":"startTime",
                          "label":"Start Time",
                          "type":"string"
                        },
                        {
                          "category":"date",
                          "name":"endTime",
                          "label":"End Time",
                          "type":"string"
                        },
                        {
                          "name":"place",
                          "label":"Place",
                          "type":"object",
                          "optional":true,
                          "fields":[
                            {
                              "name":"id",
                              "label":"Identifier",
                              "type":"number",
                              "optional":true
                            },
                            {
                              "name":"type",
                              "label":"Type",
                              "type":"string",
                              "optional":true
                            },
                            {
                              "name":"facebookPlaceId",
                              "label":"Facebook Place Id",
                              "type":"string",
                              "optional":true
                            },
                            {
                              "name":"foursquareId",
                              "label":"Foursquare Id",
                              "type":"string",
                              "optional":true
                            },
                            {
                              "name":"foursquareCategoryIds",
                              "label":"Foursquare Category Ids",
                              "type":"array",
                              "optional":true,
                              "constType":{
                                "type":"string"
                              }
                            },
                            {
                              "name":"location",
                              "label":"Location",
                              "type":"object",
                              "fields":[
                                {
                                  "name":"lat",
                                  "label":"Latitude",
                                  "type":"number"
                                },
                                {
                                  "name":"lon",
                                  "label":"Longitude",
                                  "type":"number"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "name":"activities",
                          "label":"Activities",
                          "type":"array",
                          "optional":true,
                          "constType":{
                            "type":"object",
                            "fields":[
                              {
                                "name":"activity",
                                "label":"Activity",
                                "type":"string"
                              },
                              {
                                "name":"group",
                                "label":"Group",
                                "type":"string",
                                "optional":true
                              },
                              {
                                "name":"manual",
                                "label":"Manual",
                                "type":"boolean"
                              },
                              {
                                "category":"date",
                                "name":"startTime",
                                "label":"Start Time",
                                "type":"string",
                                "optional":true
                              },
                              {
                                "category":"date",
                                "name":"endTime",
                                "label":"End Time",
                                "type":"string",
                                "optional":true
                              },
                              {
                                "name":"duration",
                                "label":"Duration",
                                "type":"number"
                              },
                              {
                                "name":"distance",
                                "label":"Distance",
                                "type":"number",
                                "optional":true
                              },
                              {
                                "name":"steps",
                                "label":"Steps",
                                "type":"number",
                                "optional":true
                              },
                              {
                                "name":"calories",
                                "label":"Calories",
                                "type":"number",
                                "optional":true
                              },
                              {
                                "name":"trackPoints",
                                "label":"Track Points",
                                "optional":true,
                                "type":"object",
                                "fields":[
                                  {
                                    "name":"lat",
                                    "label":"Latitude",
                                    "type":"number"
                                  },
                                  {
                                    "name":"lon",
                                    "label":"Longitude",
                                    "type":"number"
                                  },
                                  {
                                    "category":"date",
                                    "name":"time",
                                    "label":"Time",
                                    "type":"string"
                                  }
                                ]
                              }
                            ]
                          }
                        },
                        {
                          "category":"date",
                          "name":"lastUpdate",
                          "label":"Last Update",
                          "type":"string",
                          "optional":true
                        }
                      ]
                    }
                  },
                  {
                    "name":"caloriesIdle",
                    "label":"Calories Idle",
                    "type":"number",
                    "optional":true
                  },
                  {
                    "category":"date",
                    "name":"lastUpdate",
                    "label":"Last Update",
                    "type":"string",
                    "optional":true
                  }
                ]
              }
            ]
          }
        }
      ]
    }
  ]
}