{
  "definition_type": "bundle",
  "code": "gfhnrc_calorimeter_bundle_001",
  "version": 1,
  "name": "Calorimeter Project Setup Bundle (GFHNRC)",
  "description": "This component bundle adds the CalRQ instrument to a project, as well as the common file handlers, variables, processing jobs, and tools used in a calorimeter study.",
  "instruments": [
    {
  "definition_type": "instrument",
  "code": "calrq",
  "version": 1,
  "name": "CalRQ",
  "description": "This instrument provides an interface to importing data from the CalRQ software, which supports aquisition of data for calorimeter chambers.",
  "settings": [
    {
      "type": "integer_setting",
      "code": "pilrhealth:calrq:read_interval",
      "name": "Data Log Rate",
      "description": "Seconds between subsequent calorimeter readings",
      "value": 60,
      "min": 1,
      "max": 60,
      "required": true
    },
    {
      "type": "integer_setting",
      "code": "pilrhealth:calrq:chamber_volume",
      "name": "Chamber Volume",
      "description": "Volume of the calorimeter chamber",
      "value": 25000,
      "min": 0,
      "max": 99999,
      "required": true
    },
    {
      "type": "list_setting",
      "code": "pilrhealth:calrq:configuration",
      "name": "Calorimeter Configuration",
      "description": "Configuration of calorimeter chamber",
      "choices": [
        "Push - Differential",
        "Push - Absolute",
        "Pull - Differential",
        "Pull - Absolute"
      ],
      "value": ["Push - Absolute"],
      "required": true,
      "multipleChoice": false
    },
    {
      "type": "list_setting",
      "code": "pilrhealth:calrq:n2_mfc",
      "name": "N2 MFC Assignment",
      "description": "N2 MFC Assignment",
      "choices": [
        "MFC 1",
        "MFC 2",
        "MFC 3",
        "MFC 4",
        "MFC 5"
      ],
      "required": false,
      "multipleChoice": false
    },
    {
      "type": "list_setting",
      "code": "pilrhealth:calrq:co2_mfc",
      "name": "CO2 MFC Assignment",
      "description": "CO2 MFC Assignment",
      "choices": [
        "MFC 1",
        "MFC 2",
        "MFC 3",
        "MFC 4",
        "MFC 5"
      ],
      "required": false,
      "multipleChoice": false
    },
    {
      "type": "list_setting",
      "code": "pilrhealth:calrq:gas_type",
      "name": "Gas Type",
      "description": "Gas Type for Burn Study",
      "choices": [
        "Propane",
        "Ethanol",
        "Methanol"
      ],
      "required": false,
      "multipleChoice": false
    },
    {
      "type": "double_setting",
      "code": "pilrhealth:calrq:in_o2",
      "name": "O2 In Constant",
      "description": "O2 In Constant",
      "value" : 20.93,
      "min" : 0,
      "max" : 1000,
      "required": false
    },
    {
      "type": "double_setting",
      "code": "pilrhealth:calrq:in_co2",
      "name": "CO2 In Constant",
      "description": "CO2 In Constant",
      "value" : 0,
      "min" : 0,
      "max" : 1000,
      "required": false
    },
    {
      "type": "double_setting",
      "code": "pilrhealth:calrq:predicted_energy_balance",
      "name": "Predicted Energy Balance",
      "description": "Predicted Energy Balance",
      "value" : 0,
      "min" : -30000,
      "max" : 30000,
      "required": false
    }
  ],
  "datasets": [
    {
      "name": "CalRQ Data",
      "code": "pilrhealth:calrq:calrq_data",
      "schemas": [
        {
          "type": "concordia",
          "name": "CalRQ Data Schema",
          "schemaVersion": 1,
          "specification":
          {
          "type" : "object",
          "fields" : [
          {
                "name" : "Time",
            "type" : "string",
            "category" : "date",
                "label" : "Measurement Time",
                "doc"  : "The date and time that the CalRQ measurement was recorded"
          },
          {
            "name" : "VO2",
            "type" : "number",
                "optional" : true,
                "label" : "VO2",
                "doc" : "Oxygen consumption",
                "units" : "ml/min"
          },
          {
            "name" : "VCO2",
            "type" : "number",
                "optional" : true,
                "label" : "VCO2",
                "doc" : "Carbon dioxide production",
                "units" : "ml/min"
          },
          {
            "name" : "RQ",
            "type" : "number",
                "optional" : true,
                "label" : "Respiratory quotient",
                "doc" : "Ratio of CO2 produced to O2 consumed"
          },
          {
            "name" : "MR",
            "type" : "number",
                "optional" : true,
                "label" : "Metabolic rate",
                "doc" : "Rate of energy expenditure",
                "units" : "kcal/min"
          },
          {
            "name" : "Activity",
            "type" : "number",
                "optional" : true,
                "label" : "Activity",
                "doc" : "Seconds of activity during this measurement period",
                "units" : "counts"
          },
          {
            "name" : "InflowO2",
            "type" : "number",
                "optional" : true,
                "label" : "Oxygen inflow",
                "doc" : "Concentration of O2 going into the calorimeter",
                "units" : "vol %"
          },
          {
            "name" : "InflowCO2",
            "type" : "number",
                "optional" : true,
                "label" : "Carbon dioxide inflow",
                "doc" : "Concentration of CO2 going into the calorimeter",
                "units" : "vol %"
          },
          {
            "name" : "InflowH2O",
            "type" : "number",
                "optional" : true,
                "label" : "Water inflow",
                "doc" : "Inflow Sample Humidity",
                "units" : "PPM"
          },
          {
            "name" : "OutflowO2",
            "type" : "number",
                "label" : "Oxygen outflow",
                "doc" : "Concentration of O2 in the calorimeter sample",
                "units" : "vol %"
          },
          {
            "name" : "OutflowCO2",
            "type" : "number",
                "label" : "Carbon dioxide outflow",
                "doc" : "Concentration of CO2 in the calorimeter sample",
                "units" : "vol %"
          },
          {
            "name" : "OutflowH2O",
            "type" : "number",
                "optional" : true,
                "label" : "Water outflow",
                "doc" : "Outflow Sample Humidity",
                "units" : "PPM"
          },
          {
            "name" : "InflowRate",
            "type" : "number",
                "optional" : true,
                "label" : "Inflow Rate",
                "doc" : "Chamber Inflow Rate",
                "units" : "lpm"
          },
          {
            "name" : "OutflowRate",
            "type" : "number",
                "optional" : true,
                "label" : "Outflow Rate",
                "doc" : "Chamber Outflow Rate",
                "units" : "lpm"
          },
          {
            "name" : "ChamberTemperature",
            "type" : "number",
                "optional" : true,
                "label" : "Chamber Temperature",
                "doc" : "Temperature inside the chamber",
                "units" : "Degrees Celcius"
          },
          {
            "name" : "ChamberPressure",
            "type" : "number",
                "optional" : true,
                "label" : "Chamber Pressure",
                "doc" : "Chamber Differential Pressure",
                "units" : "???"
          },
          {
            "name" : "ChamberHumidity",
            "type" : "number",
                "optional" : true,
                "label" : "Chamber Humidity",
                "doc" : "Chamber Humidity",
                "units" : "% RH"
          },
          {
            "name" : "SampleHumidity",
            "type" : "number",
                "optional" : true,
                "label" : "Sample Humidity",
                "doc" : "",
                "units" : "PPM"
          },
          {
            "name" : "LabTemp",
            "type" : "number",
                "optional" : true,
                "label" : "Lab Temperature",
                "doc" : "Instrumentation Lab Temperature",
                "units" : "Degrees Celcius"
          },
          {
            "name" : "LabHumidity",
            "type" : "number",
                "optional" : true,
                "label" : "Lab Humidity",
                "doc" : "Instrumentation Lab Humidity",
                "units" : "% RH"
          },
          {
            "name" : "BarometricPressure",
            "type" : "number",
                "optional" : true,
                "label" : "Barometric Pressure",
                "doc" : "Instrumentation Lab Barometric Pressure",
                "units" : "kPA"
          },
          {
            "name" : "TreadmillRate",
            "type" : "number",
                "optional" : true,
                "label" : "Treadmill Rate",
                "doc" : "The rate of the treadmill during this measurement period",
                "units" : "mph"
          },
          {
            "name" : "TreadmillIncline",
            "type" : "number",
                "optional" : true,
                "label" : "Treadmill Incline",
                "doc" : "The incline of the treadmill during this measurement period",
                "units" : "%"
          },
          {
            "name" : "Alarms",
            "type" : "string",
                "optional" : true,
                "label" : "Alarms",
                "doc" : ""
              },
          {
            "name" : "Notes",
            "type" : "string",
                "optional" : true,
                "label" : "Notes",
                "doc" : "Misc notes regarding the chamber or participant"
          },
          {
            "name" : "PurgeH2O",
            "type" : "number",
                "optional" : true,
                "label" : "Purged H2O",
                "doc" : "Purge gas humidity",
                "units" : "PPM"
          },
          {
            "name" : "CumulativeEE",
            "type" : "number",
                "optional" : true,
                "label" : "Cumulative Energy Expenditure",
                "doc" : "Sum of EE During Study",
                "units" : "kCal"
          },
          {
            "name" : "ExpectedEnergyBalance",
            "type" : "number",
                "optional" : true,
                "label" : "Expected Energy Balance",
                "doc" : "",
                "units" : "kCal"
          },
            {
            "name" : "BurnWeight",
            "type" : "number",
                "optional" : true,
                "label" : "Burn Weight",
                "doc" : "Weight of fuel burned during test",
                "units" : "grams"
          },
            {
            "name" : "MFCFlow_1",
            "type" : "string",
                "optional" : true,
                "label" : "Blender MFC 1",
                "doc" : "Blender MFC 1",
                "units" : "lpm"
          },
            {
            "name" : "MFCFlow_2",
            "type" : "string",
                "optional" : true,
                "label" : "Blender MFC 2",
                "doc" : "Blender MFC 2",
                "units" : "lpm"
          },
            {
            "name" : "MFCFlow_3",
            "type" : "string",
                "optional" : true,
                "label" : "Blender MFC 3",
                "doc" : "Blender MFC 3",
                "units" : "lpm"
          },
            {
            "name" : "MFCFlow_4",
            "type" : "string",
                "optional" : true,
                "label" : "Blender MFC 4",
                "doc" : "Blender MFC 4",
                "units" : "lpm"
          },
            {
            "name" : "MFCFlow_5",
            "type" : "string",
                "optional" : true,
                "label" : "Blender MFC 5",
                "doc" : "Blender MFC 5",
                "units" : "lpm"
          },
            {
            "name" : "protein_ox",
            "type" : "number",
                "optional" : true,
                "label" : "Protein Oxidation",
                "doc" : "Protein Oxidation",
                "units" : "g/24hr"
          },
            {
            "name" : "cho_ox",
            "type" : "number",
                "optional" : true,
                "label" : "Carbohydrate Oxidation",
                "doc" : "Carbohydrate Oxidation",
                "units" : "g/24hr"
          },
            {
            "name" : "fat_ox",
            "type" : "number",
                "optional" : true,
                "label" : "Fat Oxidation",
                "doc" : "Fat Oxidation",
                "units" : "g/24hr"
          },
            {
            "name" : "nitrogen",
            "type" : "number",
                "optional" : true,
                "label" : "Urine Nitrogen Mass",
                "doc" : "Urine Nitrogen Mass",
                "units" : "grams"
          },
            {
            "name" : "np_rq",
            "type" : "number",
                "optional" : true,
                "label" : "Non-Protein RQ",
                "doc" : "Non-Protein RQ",
                "units" : ""
          }
            ]
          }
        }
      ]
    }
  ],
  "file_handlers": [
{
  "name": "CalRQ CSV File",
  "code": "pilrhealth:calorimeter:calrq_csv",
  "version": 1,
  "description": "A CSV data file output from CalRQ",
  "definition_type": "file_handler",
  "dataset": "pilrhealth:calrq:calrq_data",
  "dataset_version": 1,
  "parser": {
    "parse_by": "column_name",
    "col_name_row": 2,
    "skip_rows": 3,
    "null_expressions": ["NaN", "Inf", ""],
    "date_format": "MM/dd/yyyy HH:mm:ss",
    "data_mappings": [
      {
        "from_name": "Time",
        "to_name": "Time"
      },
      {
        "from_name": "VO2",
        "to_name": "VO2"
      },
      {
        "from_name": "VCO2",
        "to_name": "VCO2"
      },
      {
        "from_name": "RQ",
        "to_name": "RQ"
      },
      {
        "from_name": "MR",
        "to_name": "MR"
      },
      {
        "from_name": "Activity",
        "to_name": "Activity"
      },
      {
        "from_name": "InflowO2",
        "to_name": "InflowO2"
      },
      {
        "from_name": "InflowCO2",
        "to_name": "InflowCO2"
      },
      {
        "from_name": "InflowH2O",
        "to_name": "InflowH2O"
      },
      {
        "from_name": "OutflowO2",
        "to_name": "OutflowO2"
      },
      {
        "from_name": "OutflowCO2",
        "to_name": "OutflowCO2"
      },
      {
        "from_name": "OutflowH2O",
        "to_name": "OutflowH2O"
      },
      {
        "from_name": "InflowRate",
        "to_name": "InflowRate"
      },
      {
        "from_name": "OutflowRate",
        "to_name": "OutflowRate"
      },
      {
        "from_name": "ChamberTemperature",
        "to_name": "ChamberTemperature"
      },
      {
        "from_name": "ChamberPressure",
        "to_name": "ChamberPressure"
      },
      {
        "from_name": "ChamberHumidity",
        "to_name": "ChamberHumidity"
      },
      {
        "from_name": "LabTemp",
        "to_name": "LabTemp"
      },
      {
        "from_name": "LabHumidity",
        "to_name": "LabHumidity"
      },
      {
        "from_name": "BarometricPressure",
        "to_name": "BarometricPressure"
      },
      {
        "from_name": "TreadmillRate",
        "to_name": "TreadmillRate"
      },
      {
        "from_name": "TreadmillIncline",
        "to_name": "TreadmillIncline"
      },
      {
        "from_name": "CumulativeEE",
        "to_name": "CumulativeEE"
      },
      {
        "from_name": "ExpectedEnergyBalance",
        "to_name": "ExpectedEnergyBalance"
      },
      {
        "from_name": "SampleHumidity",
        "to_name": "SampleHumidity"
      },
      {
        "from_name": "PurgeH2O",
        "to_name": "PurgeH2O"
      },
      {
        "from_name": "SampleHumidity",
        "to_name": "SampleHumidity"
      },
      {
        "from_name": "BurnWeight",
        "to_name": "BurnWeight"
      },
      {
        "from_name": "MFCFlow_1",
        "to_name": "MFCFlow_1"
      },
      {
        "from_name": "MFCFlow_2",
        "to_name": "MFCFlow_2"
      },
      {
        "from_name": "MFCFlow_3",
        "to_name": "MFCFlow_3"
      },
      {
        "from_name": "MFCFlow_4",
        "to_name": "MFCFlow_4"
      },
      {
        "from_name": "MFCFlow_5",
        "to_name": "MFCFlow_5"
      },
      {
        "from_name": "Alarms",
        "to_name": "Alarms"
      },
      {
        "from_name": "Notes",
        "to_name": "Notes"
      }
    ],
    "metadata_mappings": [
      {
        "from_name": "Time",
        "to_name": "timestamp"
      }
    ]
  }
},
{
    "definition_type": "file_handler",
    "name": "CalRQ Human Report",
    "code": "pilrhealth:calrq:human_file",
    "version" : 1,
    "description" : "A report with parameters from a calorimeter human study."
},
{
    "definition_type":"file_handler",
    "name":"CalRQ Infusion Report",
    "code":"pilrhealth:calrq:infusion_file",
    "version":1,
    "unlisted":true,
    "description":"A report with parameters from a calorimeter infusion study."
},
{
    "definition_type":"file_handler",
    "name":"CalRQ Burn Report",
    "code":"pilrhealth:calrq:burn_file",
    "version":1,
    "unlisted":true,
    "description":"A report with parameters from a calorimeter burn study."
}
  ]
}

  ],
  "variables": [
    {
      "type": "double_setting",
      "code": "pilrhealth:calrq:weight_in",
      "name": "Weight In (Kg)",
      "description": "Weight In (Kg)",
      "units": "Kg",
      "value": 0,
      "min": 0,
      "max": 1000
    },
    {
      "type": "double_setting",
      "code": "pilrhealth:calrq:weight_out",
      "name": "Weight Out (Kg)",
      "description": "Weight Out (Kg)",
      "units": "Kg",
      "value": 0,
      "min": 0,
      "max": 1000
    },
    {
      "type": "integer_setting",
      "code": "pilrhealth:calrq:energy_intake_measured",
      "name": "Energy Intake Measured (kCal)",
      "description": "Energy Intake Measured (kCal)",
      "units": "kCal",
      "value": 0,
      "min": 0,
      "max": 30000
    },
    {
      "type": "integer_setting",
      "code": "pilrhealth:calrq:energy_intake_predicted",
      "name": "Energy Intake Predicted (kCal)",
      "description": "Energy Intake Predicted (kCal)",
      "units": "kCal",
      "value": 0,
      "min": 0,
      "max": 30000
    },
    {
      "type": "text_setting",
      "code": "pilrhealth:calrq:diet",
      "name": "Diet",
      "description": "Diet"
    },
    {
      "type": "text_setting",
      "code": "pilrhealth:calrq:exercise_level",
      "name": "Exercise Level",
      "description": "Exercise Level"
    },
    {
      "type": "text_setting",
      "code": "pilrhealth:calrq:treatment",
      "name": "Treatment",
      "description": "Treatment"
    },
    {
      "type": "array_setting",
      "code": "pilrhealth:calrq:multiple_n2",
      "name": "Urine Nitrogen Mass",
      "description": "Urine Nitrogen Mass",
      "choices": [
        {
          "fields": [
            {
              "min": 0,
              "max": 10,
              "description": "Urine Nitrogen Mass",
              "name": "Urine Nitrogen Mass",
              "value": 0,
              "code": "pilrhealth:calrq:urine_nitrogen_value",
              "type": "double_setting",
              "units": ""
            },
            {
              "description": "Urine Nitrogen Collection Date",
              "name": "Urine Nitrogen Collection Date",
              "code": "pilrhealth:calrq:urine_nitrogen_date",
              "type": "date_setting",
              "units": ""
            },
            {
              "description": "Urine Nitrogen Collection Time",
              "name": "Urine Nitrogen Collection Time",
              "code": "pilrhealth:calrq:urine_nitrogen_time",
              "type": "time_setting",
              "units": ""
            }
          ]
        }
      ]
    },
    {
      "type": "array_setting",
      "code": "pilrhealth:calrq:rest_durations",
      "name": "Rest Durations",
      "description": "Rest Durations",
      "choices": [
        {
          "fields": [
            {
              "min": 0,
              "max": 10000,
              "description": "Post Meal Rest Duration",
              "name": "Post Meal Rest Duration",
              "value": 360,
              "code": "pilrhealth:calrq:post_meal_duration",
              "type": "integer_setting",
              "units": "minutes"
            },
            {
              "min": 0,
              "max": 10000,
              "description": "Rest Duration",
              "name": "Rest Duration",
              "value": 1080,
              "code": "pilrhealth:calrq:rest_duration",
              "type": "integer_setting",
              "units": "minutes"
            }
          ]
        }
      ]
    },
	{
        "type":"double_setting",
        "code":"pilrhealth:calrq:sleep_threshold",
        "name":"Sleep Threshold",
        "description":"Sleep Threshold",
        "value":3,
        "min":-100,
        "max":100,
        "required":false
	}
  ],
  "tools": [
{
    "code":"processing_with_r",
    "version":1,
    "name":"Processing with R",
    "description":"The \"Processing with R\" tools tool allows you to view and run workflows that have been setup to process dataset thru R scripts.",
    "definition_type":"tool",
    "customizations":{
        "package":"com.pilrhealth.tools.processing_with_r",
        "classnamePrefix":"RProc",
        "apix":true,
        "controllers":{
            "coordinate":"RProcEditor",
            "portal":"RProcView"
        }
    }
},
{
    "code":"evtagger",
    "version":1,
    "name":"Event Tag Editor",
    "description":"The \"Event Tag Editor\" tool allows you to plot data from a dataset, and \"tag\" event time intervals through a visual click and drag feature.  This makes it easy to view and update event times and tags quickly for many participants.",
    "definition_type":"tool",
    "customizations":{
        "package":"com.pilrhealth.tools.evtagger",
        "classnamePrefix":"EvTag",
        "apix":true,
        "controllers":{
            "configure":"EvTagConfig",
            "coordinate":"EvTagEditor",
            "portal":"EvTagView"
        },
        "services":{
            "handleContent":"EvTag"
        }
    },
    "datasets":[
        {
            "code":"pilrhealth:time_analysis:tagged_event",
            "name":"Tagged Events",
            "schemas":[
                {
                    "type":"concordia",
                    "code":"remove",
                    "name":"remove",
                    "schemaVersion":1,
                    "specification":{
                        "fields":[
                            {
                                "name":"number",
                                "type":"number",
                                "label":"Event Number",
                                "doc":"A unique identifier for an event."
                            },
                            {
                                "category":"date",
                                "name":"start_time",
                                "type":"string",
                                "label":"Event Start Time",
                                "doc":"The date and time of the start of the event."
                            },
                            {
                                "category":"date",
                                "name":"end_time",
                                "type":"string",
                                "label":"Event End Time",
                                "doc":"The date and time of the end of the event."
                            },
                            {
                                "name":"note",
                                "type":"string",
                                "optional":true,
                                "label":"Tag Note",
                                "doc":"Arbitrary notes on the event or tags."
                            },
                            {
                                "constType":{
                                    "type":"string"
                                },
                                "name":"tags",
                                "type":"array",
                                "label":"List of Tags",
                                "doc":"One or more tags that label the event."
                            },
                            {
                                "name":"verified",
                                "type":"boolean",
                                "label":"Tag Verified",
                                "doc":"Has this event been verified?"
                            },
                            {
                                "name":"profile_code",
                                "type":"string",
                                "optional":true,
                                "label":"Profile Code",
                                "doc":"The profile code from which the event was created."
                            },
                            {
                                "name":"profile_version",
                                "type":"number",
                                "optional":true,
                                "label":"Profile Version",
                                "doc":"The version of the profile code from which the event was created."
                            }
                        ],
                        "type":"object"
                    }
                }
            ]
        }
    ]
}
  ],
  "jobs": [
{
      "definition_type": "job",
      "code":"calorimeter_burn_summary_job_rc1",
      "name": "Burn CalRQ Summary RC1",
      "version": 1,
      "description": "Compute summaries and generate report for CalRQ burn studies.",
      "datasets": [
        {
          "name": "CalRQ Burn Summary",
          "code": "pilrhealth:calrq:burn_summary",
          "schemas": [
            {
              "type": "concordia",
              "name": "CalRQ Burn Summary",
              "schemaVersion": 1,
              "specification": {
                "type":"object",
                "fields": [
                  {
                    "name":"start_time",
                    "type":"string",
                    "category":"date",
                    "label" : "Summary Start Time"
                  },
                  {
                    "name":"end_time",
                    "type":"string",
                    "category": "date",
                    "label" : "Summary End Time"
                  },
                  {
                    "name":"vco2_meas",
                    "type":"number",
                    "label" : "VCO2 Measured"
                  },
                  {
                    "name":"vo2_meas",
                    "type":"number",
                    "label" : "VO2 Measured"
                  },
                  {
                    "name":"ee_meas",
                    "type":"number",
                    "label" : "EE Measured"
                  },
                  {
                    "name":"rq_meas",
                    "type":"number",
                    "label" : "RQ Measured"
                  },
                  {
                    "name":"vco2_exp",
                    "type":"number",
                    "label" : "VCO2 Expected"
                  },
                  {
                    "name":"vo2_exp",
                    "type":"number",
                    "label" : "VO2 Expected"
                  },
                  {
                    "name":"ee_exp",
                    "type":"number",
                    "label" : "EE Expected"
                  },
                  {
                    "name":"rq_exp",
                    "type":"number",
                    "label" : "RQ Expected"
                  },
                  {
                    "name":"vco2_err",
                    "type":"number",
                    "label" : "VCO2 Error"
                  },
                  {
                    "name":"vo2_err",
                    "type":"number",
                    "label" : "VO2 Error"
                  },
                  {
                    "name":"ee_err",
                    "type":"number",
                    "label" : "EE Error"
                  },
                  {
                    "name":"rq_err",
                    "type":"number",
                    "label" : "RQ Error"
                  },
                  {
                    "name":"null_offset_o2",
                    "type":"number",
                    "label" : "Null Offset - O2"
                  },
                  {
                    "name":"null_offset_co2",
                    "type":"number",
                    "label" : "Null Offset - CO2"
                  },
                  {
                    "name":"tag_label",
                    "type":"string",
                    "label" : "Time Tag Label"
                  }
                ]
              }
            }
          ]
        }
      ],
      "runner": {
        "clazz": "com.pilrhealth.tools.processing_with_r.RProcOpenCPUJobRunner",
        "save_request": 0,
        "save_response": 0,
        "delete_if_successful": 0,
        "package_url": "https://www.github.com/MeiResearchLtd/mei.calorimeter.r",
        "package_function": "process_cal_burn",
        "package_version": "GF-Custom",
        "resource_path": "/github/MeiResearchLtd/pilr.dpu.r/R/pilr_dpu",
        "input_datasets": [
          {
            "code": "pilrhealth:calrq:calrq_data",
            "version": 1,
            "mapping" : "calrq"
          },
          {
            "code": "pilrhealth:time_analysis:tagged_event",
            "version": 1,
            "mapping" : "event_tags"
          }
        ],
        "input_file_types": [],
        "input_settings": [
          {
            "code": "pilrhealth:calrq:read_interval",
            "mapping": "read_interval"
          },
          {
            "code": "pilrhealth:calrq:configuration",
            "mapping":"configuration"
          },
          {
            "code": "pilrhealth:calrq:gas_type",
            "mapping":"gas"
          },
          {
            "code": "pilrhealth:calrq:chamber_volume",
            "mapping":"volume"
          },
          {
            "code": "pilrhealth:calrq:co2_mfc",
            "mapping":"CO2_MFC"
          },
          {
            "code": "pilrhealth:calrq:n2_mfc",
            "mapping":"N2_MFC"
          },
          {
            "code": "pilrhealth:calrq:in_o2",
            "mapping": "in_o2"
          },
          {
            "code": "pilrhealth:calrq:in_co2",
            "mapping": "in_co2"
          }
        ],
        "filter_params": [
          "participant",
          "date_range",
          "period"
        ],
        "input_params": [],
        "output_datasets": [
          {
            "code": "pilrhealth:calrq:burn_summary",
            "version": 1,
            "mapping" : "burn"
          },
          {
            "code": "pilrhealth:calrq:haldane",
            "version": 1,
            "mapping" : "haldane"
          }
        ],
        "output_file_types":[
          { 
            "code" : "pilrhealth:calrq:burn_file",
            "version" : 1, 
            "mapping" : "burn",
            "extension": "pdf",
            "filename_prefix": "burn_summary"
          }
        ]
      }
    },
{
  "definition_type": "job",
  "code": "calorimeter_human_summary_job_rc1_gf",
  "name": "Human CalRQ Summary v1.1 (GF Custom)",
  "version": 1,
  "description": "Compute summaries and generate report for CalRQ human studies.",
  "datasets": [
    {
      "name": "CalRQ Human Summary",
      "code": "pilrhealth:calrq:human_summary",
      "schemas": [
        {
          "type": "concordia",
          "name": "CalRQ Human Summary",
          "schemaVersion": 1,
          "specification": {
            "type": "object",
            "fields": [
              {
                "name": "Processed",
                "type": "string",
                "category": "date"
              },
              {
                "name": "start_time",
                "type": "string",
                "category": "date",
                "label": "Summary Start Time"
              },
              {
                "name": "end_time",
                "type": "string",
                "category": "date",
                "label": "Summary End Time"
              },
              {
                "name": "rmr_intercept",
                "type": "number",
                "label": "RMR Regression Intercept"
              },
              {
                "name": "minutes",
                "type": "number",
                "label": "Number of Minutes",
                "units": "Minutes"
              },
              {
                "name": "mr",
                "type": "number",
                "label": "MR"
              },
              {
                "name": "ee",
                "type": "number",
                "label": "EE"
              },
              {
                "name": "ee_no_tf_correct",
                "type": "number",
                "label": "EE (No 24-hour correction)"
              },
              {
                "name": "ee_nn",
                "type": "number",
                "label": "EE (No Nitrogen Correction)"
              },
              {
                "name": "ee_nn_no_tf_correct",
                "type": "number",
                "label": "EE, (No Nitrogen Correction, No 24-hour correction)"
              },
              {
                "name": "rq",
                "type": "number",
                "label": "RQ"
              },
              {
                "name": "vo2",
                "type": "number",
                "label": "VO2"
              },
              {
                "name": "vo2_no_tf_correct",
                "type": "number",
                "label": "VO2 (No 24-hour correction)"
              },
              {
                "name": "vco2",
                "type": "number",
                "label": "VCO2"
              },
              {
                "name": "vco2_no_tf_correct",
                "type": "number",
                "label": "VCO2 (No 24-hour correction)"
              },
              {
                "name": "np_rq",
                "type": "number",
                "label": "NP RQ"
              },
              {
                "name": "cho_ox",
                "type": "number",
                "label": "Carbohydrate Oxidation"
              },
              {
                "name": "fat_ox",
                "type": "number",
                "label": "Fat Oxidation"
              },
              {
                "name": "protein_ox",
                "type": "number",
                "label": "Protein Oxidation"
              },
              {
                "name": "tef1",
                "type": "number",
                "label": "???"
              },
              {
                "name": "tef2",
                "type": "number",
                "label": "???"
              },
              {
                "name": "activity",
                "type": "number",
                "label": "Activity"
              },
              {
                "name": "spa",
                "type": "number",
                "label": "Spontaneous Physical Activity"
              },
              {
                "name": "activity_minutes",
                "type": "number",
                "label": "Activity Minutes",
                "units": "minutes"
              },
              {
                "name": "activity_pct",
                "type": "number",
                "label": "Activity Percent",
                "units": "%"
              },
              {
                "name": "null_offset_o2",
                "type": "number",
                "label": "Null Offset, O2"
              },
              {
                "name": "null_offset_co2",
                "type": "number",
                "label": "Null Offset, CO2"
              },
              {
                "name": "tag_label",
                "type": "string",
                "label": "Time Tag Label"
              },
              {
                "name": "note",
                "type": "string",
                "label": "Note"
              }
            ]
          }
        }
      ]
    }
  ],
  "runner": {
    "clazz": "com.pilrhealth.tools.processing_with_r.RProcOpenCPUJobRunner",
    "save_request": 1,
    "save_response": 1,
    "delete_if_successful": 0,
    "package_url": "https://github.com/MeiResearchLtd/mei.calorimeter.r",
    "package_function": "process_cal_human",
    "package_version": "release/GF-Custom-1.1",
    "resource_path": "/github/MeiResearchLtd/pilr.dpu.r/R/pilr_dpu",
    "input_datasets": [
      {
        "code": "pilrhealth:calrq:calrq_data",
        "version": 1,
        "mapping": "calrq"
      },
      {
        "code": "pilrhealth:time_analysis:tagged_event",
        "version": 1,
        "mapping": "event_tags"
      }
    ],
    "input_file_types": [
      
    ],
    "input_settings": [
      {
        "code": "pilrhealth:calrq:energy_intake_measured",
        "mapping": "energy_intake_measured"
      },
      {
        "code": "pilrhealth:calrq:read_interval",
        "mapping": "read_interval"
      },
      {
        "code": "pilrhealth:calrq:configuration",
        "mapping": "configuration"
      },
      {
        "code": "pilrhealth:calrq:chamber_volume",
        "mapping": "volume"
      },
      {
        "code": "pilrhealth:calrq:in_o2",
        "mapping": "in_o2"
      },
      {
        "code": "pilrhealth:calrq:in_co2",
        "mapping": "in_co2"
      },
      {
        "code": "pilrhealth:calrq:weight_in",
        "mapping": "weight_in"
      },
      {
        "code": "pilrhealth:calrq:weight_out",
        "mapping": "weight_out"
      },
      {
        "code": "pilrhealth:calrq:energy_intake_measured",
        "mapping": "energy_intake_measured"
      },
      {
        "code": "pilrhealth:calrq:energy_intake_predicted",
        "mapping": "energy_intake_predicted"
      },
      {
        "code": "pilrhealth:calrq:diet",
        "mapping": "diet"
      },
      {
        "code": "pilrhealth:calrq:exercise_level",
        "mapping": "exercise_level"
      },
      {
        "code": "pilrhealth:calrq:treatment",
        "mapping": "treatment"
      },
      {
        "code": "pilrhealth:calrq:multiple_n2",
        "mapping": "multiple_n2"
      },
      {
		"code": "pilrhealth:calrq:rest_durations",
		"mapping": "rest_durations"
      },
	  {
		"code":"pilrhealth:calrq:sleep_threshold",
		"mapping":"sleep_threshold"
	  }
    ],
    "filter_params": [
      "participant",
      "date_range",
      "period"
    ],
    "input_params": [
      
    ],
    "output_datasets": [
      {
        "code": "pilrhealth:calrq:haldane",
        "version": 1,
        "mapping": "haldane"
      },
      {
        "code": "pilrhealth:calrq:human_summary",
        "version": 1,
        "mapping": "human"
      }
    ],
    "output_file_types": [
      {
        "code": "pilrhealth:calrq:human_file",
        "version": 1,
        "mapping": "human",
        "extension": "pdf",
        "filename_prefix": "human_summary"
      }
    ]
  }
},
{
      "definition_type": "job",
      "code":"calorimeter_infusion_summary_job_rc1",
      "name": "Infusion CalRQ Summary RC1",
      "version": 1,
      "description": "Compute summaries and generate report for CalRQ infusion studies.",
      "datasets": [
{
      "name": "CalRQ Infusion Summary",
      "code": "pilrhealth:calrq:infusion_summary",
      "schemas": [
        {
          "type": "concordia",
          "name": "CalRQ Infusion Summary",
          "schemaVersion": 1,
          "specification": {
            "type":"object",
            "fields": [
              {
                "name":"start_time",
                "type":"string",
                "category":"date"
              },
              {
                "name":"end_time",
                "type":"string",
                "category": "date"
              },
              {
                "name":"vco2_meas",
                "type":"number"
              },
              {
                "name":"vo2_meas",
                "type":"number"
              },
              {
                "name":"ee_meas",
                "type":"number"
              },
              {
                "name":"rq_meas",
                "type":"number"
              },
              {
                "name":"vco2_exp",
                "type":"number"
              },
              {
                "name":"vo2_exp",
                "type":"number"
              },
              {
                "name":"ee_exp",
                "type":"number"
              },
              {
                "name":"rq_exp",
                "type":"number"
              },
              {
                "name":"vco2_err",
                "type":"number"
              },
              {
                "name":"vo2_err",
                "type":"number"
              },
              {
                "name":"ee_err",
                "type":"number"
              },
              {
                "name":"rq_err",
                "type":"number"
              },
              {
                "name":"null_offset_o2",
                "type":"number"
              },
              {
                "name":"null_offset_co2",
                "type":"number"
              },
              {
                "name":"tag_label",
                "type":"string"
              }
            ]
          }
        }
      ]
    }
      ],
      "runner": {
        "clazz": "com.pilrhealth.tools.processing_with_r.RProcOpenCPUJobRunner",
        "save_request": 0,
        "save_response": 0,
        "delete_if_successful": 0,
        "package_url": "https://www.github.com/MeiResearchLtd/mei.calorimeter.r",
        "package_function": "process_cal_infusion",
        "package_version": "GF-Custom",
        "resource_path": "/github/MeiResearchLtd/pilr.dpu.r/R/pilr_dpu",
        "input_datasets": [
          {
            "code": "pilrhealth:calrq:calrq_data",
            "version": 1,
            "mapping" : "calrq"
          },
          {
            "code": "pilrhealth:time_analysis:tagged_event",
            "version": 1,
            "mapping" : "event_tags"
          }
        ],
        "input_file_types": [],
        "input_settings": [
          {
            "code": "pilrhealth:calrq:read_interval",
            "mapping": "read_interval"
          },
          {
            "code": "pilrhealth:calrq:configuration",
            "mapping":"configuration"
          },
          {
            "code": "pilrhealth:calrq:chamber_volume",
            "mapping":"volume"
          },
          {
            "code": "pilrhealth:calrq:co2_mfc",
            "mapping":"CO2_MFC"
          },
          {
            "code": "pilrhealth:calrq:n2_mfc",
            "mapping":"N2_MFC"
          },
          {
            "code": "pilrhealth:calrq:in_o2",
            "mapping": "in_o2"
          },
          {
            "code": "pilrhealth:calrq:in_co2",
            "mapping": "in_co2"
          }
        ],
        "filter_params": [
          "participant",
          "date_range",
          "period"
        ],
        "input_params": [],
        "output_datasets": [
          {
            "code": "pilrhealth:calrq:infusion_summary",
            "version": 1,
            "mapping" : "infusion"
          },
          {
            "code": "pilrhealth:calrq:haldane",
            "version": 1,
            "mapping" : "haldane"
          }
        ],
        "output_file_types":[
          { 
            "code" : "pilrhealth:calrq:infusion_file",
            "version" : 1, 
            "mapping" : "infusion",
            "extension": "pdf",
            "filename_prefix": "infusion_summary"
          }
        ]
      }
    },
{
      "definition_type": "job",
      "code":"calorimeter_haldane_transform_job_gf_custom",
      "name": "Haldane Transform - Pre Event Tag (GF Custom)",
      "version": 1,
      "description": "Compute summaries and generate report for CalRQ human studies.",
      "datasets": [
        {
      "name": "Haldane Transform",
      "code": "pilrhealth:calrq:haldane",
      "schemas": [
        {
          "type": "concordia",
          "name": "Location Schema",
          "schemaVersion": 1,
          "specification": {
            "type":"object",
            "fields": [
							{
                  "name":"Processed",
                  "type":"string",
                  "category":"date"
              },
              {
                "name":"Time",
                "type":"string",
                "category":"date"
              },
              {
                "name":"haldane",
                "type":"number"
              },
              {
                "name":"recalc_vo2",
                "type":"number"
              },
              {
                "name":"recalc_vco2",
                "type":"number"
              },
              {
                "name":"recalc_ee",
                "type":"number"
              },
              {
                "name":"recalc_rq",
                "type":"number"
              },
              {
                "name":"nulled_outflow_o2",
                "type":"number"
              },
              {
                "name":"nulled_outflow_co2",
                "type":"number"
              },
              {
                "name":"nulled_inflow_o2",
                "type":"number"
              },
              {
                "name":"nulled_inflow_co2",
                "type":"number"
              },
              {
                "name":"do2",
                "type":"number"
              },
              {
                "name":"dco2",
                "type":"number"
              },
              {
                "name":"inflow_rate",
                "type":"number"
              },
              {
                "name":"outflow_rate",
                "type":"number"
              },
            {
            "name" : "protein_ox",
            "type" : "number",
                "optional" : true,
                "label" : "Protein Oxidation",
                "doc" : "Protein Oxidation",
                "units" : "g/24hr"
          },
            {
            "name" : "cho_ox",
            "type" : "number",
                "optional" : true,
                "label" : "Carbohydrate Oxidation",
                "doc" : "Carbohydrate Oxidation",
                "units" : "g/24hr"
          },
            {
            "name" : "fat_ox",
            "type" : "number",
                "optional" : true,
                "label" : "Fat Oxidation",
                "doc" : "Fat Oxidation",
                "units" : "g/24hr"
          },
            {
            "name" : "nitrogen",
            "type" : "number",
                "optional" : true,
                "label" : "Urine Nitrogen Mass",
                "doc" : "Urine Nitrogen Mass",
                "units" : "grams"
          },
            {
            "name" : "np_rq",
            "type" : "number",
                "optional" : true,
                "label" : "Non-Protein RQ",
                "doc" : "Non-Protein RQ",
                "units" : ""
          }
            ]
          }
        }
      ]
    },
    {
      "name": "Haldane Pre Event Tag Data",
      "code": "pilrhealth:calrq:haldane_pet",
      "schemas": [
        {
          "type": "concordia",
          "name": "Location Schema",
          "schemaVersion": 1,
          "specification": {
            "type":"object",
            "fields": [
              {
                "name":"Time",
                "type":"string",
                "category":"date"
              },
              {
                "name":"haldane",
                "type":"number"
              },
              {
                "name":"recalc_vo2",
                "type":"number"
              },
              {
                "name":"recalc_vco2",
                "type":"number"
              },
              {
                "name":"recalc_ee",
                "type":"number"
              },
              {
                "name":"recalc_rq",
                "type":"number"
              },
              {
                "name":"nulled_outflow_o2",
                "type":"number"
              },
              {
                "name":"nulled_outflow_co2",
                "type":"number"
              },
              {
                "name":"nulled_inflow_o2",
                "type":"number"
              },
              {
                "name":"nulled_inflow_co2",
                "type":"number"
              },
              {
                "name":"do2",
                "type":"number"
              },
              {
                "name":"dco2",
                "type":"number"
              },
              {
                "name":"inflow_rate",
                "type":"number"
              },
              {
                "name":"outflow_rate",
                "type":"number"
              }
            ]
          }
        }
      ]
    }
      ],
      "runner": {
        "clazz": "com.pilrhealth.tools.processing_with_r.RProcOpenCPUJobRunner",
        "save_request": 0,
        "save_response": 0,
        "delete_if_successful": 0,
        "package_url": "https://github.com/MeiResearchLtd/mei.calorimeter.r",
        "package_function": "apply_haldane",
        "package_version": "GF-Custom",
        "resource_path": "/github/MeiResearchLtd/pilr.dpu.r/R/pilr_dpu",
        "input_datasets": [
          {
            "code": "pilrhealth:calrq:calrq_data",
            "version": 1,
            "mapping": "calrq"
          }
        ],
        "input_file_types": [],
        "input_settings": [
          {
            "code": "pilrhealth:calrq:read_interval",
            "mapping": "read_interval"
          },
          {
            "code": "pilrhealth:calrq:configuration",
            "mapping":"configuration"
          },
          {
            "code": "pilrhealth:calrq:chamber_volume",
            "mapping":"volume"
          },
          {
            "code": "pilrhealth:calrq:in_o2",
            "mapping": "in_o2"
          },
          {
            "code": "pilrhealth:calrq:in_co2",
            "mapping": "in_co2"
          },
          {  
            "code":"pilrhealth:calrq:multiple_n2",
            "mapping":"multiple_n2"
          },
          {
	      "code": "pilrhealth:calrq:rest_durations",
	      "mapping": "rest_durations"
          }
        ],
        "filter_params": [
          "participant",
          "date_range",
          "period"
        ],
        "input_params": [],
        "output_datasets": [
          {
            "code": "pilrhealth:calrq:haldane_pet",
            "version": 1,
            "mapping": "haldane"
          }
        ],
        "output_file_types":[]
      }
    }
  ],
  "tool_contents": [
{
  "definition_type": "tool_content",
  "tool_code": "evtagger",
  "code": "calorimeter_evtagger_config_001",
  "version": 1,
  "name": "Sample tag labels and event bundles for calorimeter study",
  "description": "A sample of tag labels and event bundles commonly used for segmenting data in studies that use a calorimeter chamber.",
  "contents": [
    {
      "labels": [
        {
          "name": "Human Study",
          "description": "Human study tag."
        },
        {
          "name": "Sleep",
          "description": "Sleep time."
        },
        {
          "name": "Exercise",
          "description": "Exercise."
        },
        {
          "name": "Rest",
          "description": "Rest"
        },
        {
          "name": "Null",
          "description": "Null"
        },
        {
          "name": "Invalid",
          "description": "Invalid"
        },
        {
          "name": "Misc",
          "description": "Misc."
        },
        {
          "name": "Meal 1",
          "description": "Meal 1"
        },
        {
          "name": "Meal 2",
          "description": "Meal 2"
        },
        {
          "name": "Meal 3",
          "description": "Meal 3"
        },
        {
          "name": "Post Meal 1",
          "description": "Post Meal 1"
        },
        {
          "name": "Post Meal 2",
          "description": "Post Meal 2"
        },
        {
          "name": "Post Meal 3",
          "description": "Post Meal 3"
        },
        {
          "name": "Regression 1",
          "description": "Regression 1"
        },
        {
          "name": "Regression 2",
          "description": "Regression 2"
        },
        {
          "name": "Regression 3",
          "description": "Regression 3"
        }
      ],
      "bundles": [
        {
          "name": "Daily routine",
          "description": ".",
          "events": [
            {
              "name": "Exercise session 1",
              "note": "Time the participant was doing the first exercise in the chamber.",
              "verified": 1,
              "offset": 176490000,
              "duration": 7200000,
              "startTime": "01:01:30",
              "durationTime": "02:00:00",
              "startDays": 0,
              "tags": ["Exercise"]
            }
          ]
        }
      ]
    }
  ]
}
  ],
   "periods":[  
      {  
         "code":"active_period",
         "name":"Participant Active Period",
         "epochs":[  
            {  
               "code":"epoch_1",
               "name":"Epoch 1"
            }
         ]
      }
   ],
   "templates":[  
      {  
         "code":"calrq_default_template",
         "name":"Default Template",
         "activeInstruments":[  
            {  
               "instrument":"calrq",
		"settings":[  
                  {  
                     "code":"pilrhealth:calrq:chamber_volume",
                     "period":null,
                     "epoch":null,
                     "value":31000
                  },
                  {  
                     "code":"pilrhealth:calrq:co2_mfc",
                     "period":null,
                     "epoch":null,
                     "value":null
                  },
                  {  
                     "code":"pilrhealth:calrq:configuration",
                     "period":null,
                     "epoch":null,
                     "value":[  
                        "Push - Absolute"
                     ]
                  },
                  {  
                     "code":"pilrhealth:calrq:gas_type",
                     "period":null,
                     "epoch":null,
                     "value":null
                  },
                  {  
                     "code":"pilrhealth:calrq:in_co2",
                     "period":null,
                     "epoch":null,
                     "value":0.0
                  },
                  {  
                     "code":"pilrhealth:calrq:in_o2",
                     "period":null,
                     "epoch":null,
                     "value":20.93
                  },
                  {  
                     "code":"pilrhealth:calrq:n2_mfc",
                     "period":null,
                     "epoch":null,
                     "value":null
                  },
                  {  
                     "code":"pilrhealth:calrq:predicted_energy_balance",
                     "period":null,
                     "epoch":null,
                     "value":0.0
                  },
                  {  
                     "code":"pilrhealth:calrq:read_interval",
                     "period":null,
                     "epoch":null,
                     "value":60
                  }
               ],
               "periodSchedules":[  
                  {  
                     "period":"active_period",
                     "epochSchedules":[  
                        {  
                           "period":"active_period",
                           "epoch":"epoch_1",
                           "startDay":1,
                           "endDay":2
                        }
                     ]
                  }
               ]
            }
         ]
      }
   ]
}
